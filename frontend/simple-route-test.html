<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç®€å•è·¯ç”±æµ‹è¯•</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      .container {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      button {
        background: #dc2626;
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
      }
      button:hover {
        background: #b91c1c;
      }
      .status {
        padding: 15px;
        border-radius: 6px;
        margin: 15px 0;
        font-weight: bold;
        text-align: center;
      }
      .success {
        background: #d1fae5;
        color: #065f46;
      }
      .error {
        background: #fee2e2;
        color: #991b1b;
      }
      .info {
        background: #dbeafe;
        color: #1e40af;
      }
      .logs {
        background: #1f2937;
        color: #f9fafb;
        padding: 15px;
        border-radius: 6px;
        font-family: monospace;
        font-size: 12px;
        max-height: 200px;
        overflow-y: auto;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸš¨ ç´§æ€¥æ±‚åŠ©åŠŸèƒ½æµ‹è¯•</h1>
      <p>
        <strong>æµ‹è¯•ç›®æ ‡</strong>ï¼šéªŒè¯ä¸»åº”ç”¨ä¸­çš„"ç´§æ€¥æ±‚åŠ©"æŒ‰é’®æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œ
      </p>

      <div id="status" class="status info">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•</div>

      <div style="text-align: center; margin: 30px 0">
        <button onclick="startTest()">ğŸš¨ å¼€å§‹æµ‹è¯•ç´§æ€¥æ±‚åŠ©åŠŸèƒ½</button>
      </div>

      <div class="info">
        <strong>æµ‹è¯•æ­¥éª¤ï¼š</strong>
        <ol>
          <li>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ‰“å¼€ä¸»åº”ç”¨</li>
          <li>åœ¨ä¸»åº”ç”¨ä¸­ç‚¹å‡»"ç´§æ€¥æ±‚åŠ©"æŒ‰é’®</li>
          <li>è§‚å¯Ÿé¡µé¢æ˜¯å¦åˆ‡æ¢åˆ°ç´§æ€¥æ±‚åŠ©é¡µé¢</li>
          <li>æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºç´§æ€¥æƒ…å†µè¡¨å•</li>
        </ol>
      </div>
    </div>

    <div class="container">
      <h2>ğŸ“ æµ‹è¯•æ—¥å¿—</h2>
      <div id="logs" class="logs">ç­‰å¾…å¼€å§‹æµ‹è¯•...</div>
    </div>

    <script>
      function log(message) {
        const logsDiv = document.getElementById("logs");
        const timestamp = new Date().toLocaleTimeString();
        logsDiv.innerHTML += `\n[${timestamp}] ${message}`;
        logsDiv.scrollTop = logsDiv.scrollHeight;
        console.log(message);
      }

      function updateStatus(message, type = "info") {
        const statusDiv = document.getElementById("status");
        statusDiv.innerHTML = message;
        statusDiv.className = `status ${type}`;
      }

      function startTest() {
        log("å¼€å§‹æµ‹è¯•ç´§æ€¥æ±‚åŠ©åŠŸèƒ½...");
        updateStatus("æ­£åœ¨æ‰“å¼€ä¸»åº”ç”¨ï¼Œè¯·åœ¨æ–°çª—å£ä¸­æµ‹è¯•...", "info");

        // æ‰“å¼€ä¸»åº”ç”¨
        const mainAppWindow = window.open("http://localhost:5173", "_blank");

        if (mainAppWindow) {
          log("ä¸»åº”ç”¨å·²åœ¨æ–°çª—å£æ‰“å¼€");
          log("è¯·åœ¨æ–°çª—å£ä¸­ï¼š");
          log("1. ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½");
          log('2. æ‰¾åˆ°"ç´§æ€¥æ±‚åŠ©"æŒ‰é’®ï¼ˆçº¢è‰²æŒ‰é’®ï¼‰');
          log('3. ç‚¹å‡»"ç´§æ€¥æ±‚åŠ©"æŒ‰é’®');
          log("4. è§‚å¯Ÿé¡µé¢æ˜¯å¦åˆ‡æ¢");

          updateStatus("âœ… ä¸»åº”ç”¨å·²æ‰“å¼€ï¼Œè¯·æŒ‰ç…§æ—¥å¿—ä¸­çš„æ­¥éª¤æ“ä½œ", "success");

          // 5ç§’åæä¾›è¿›ä¸€æ­¥æŒ‡å¯¼
          setTimeout(() => {
            log("");
            log("=== é¢„æœŸç»“æœ ===");
            log("âœ… é¡µé¢åº”è¯¥ä»ä»ªè¡¨æ¿åˆ‡æ¢åˆ°ç´§æ€¥æ±‚åŠ©é¡µé¢");
            log("âœ… åº”è¯¥çœ‹åˆ°ç´§æ€¥æƒ…å†µåˆ›å»ºè¡¨å•");
            log("âœ… URLåº”è¯¥å˜ä¸º: /emergency");
            log("");
            log("=== å¦‚æœæ²¡æœ‰åˆ‡æ¢ ===");
            log("âŒ æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·");
            log("âŒ æŸ¥çœ‹Consoleæ ‡ç­¾é¡µçš„é”™è¯¯ä¿¡æ¯");
            log("âŒ æ£€æŸ¥æ˜¯å¦æœ‰JavaScripté”™è¯¯");
          }, 5000);

          // 10ç§’åè¯¢é—®æµ‹è¯•ç»“æœ
          setTimeout(() => {
            const result = confirm(
              'æµ‹è¯•å®Œæˆäº†å—ï¼Ÿ\n\nç‚¹å‡»"ç¡®å®š"å¦‚æœç´§æ€¥æ±‚åŠ©åŠŸèƒ½æ­£å¸¸å·¥ä½œ\nç‚¹å‡»"å–æ¶ˆ"å¦‚æœä»ç„¶æœ‰é—®é¢˜'
            );

            if (result) {
              updateStatus("ğŸ‰ æµ‹è¯•æˆåŠŸï¼ç´§æ€¥æ±‚åŠ©åŠŸèƒ½æ­£å¸¸å·¥ä½œ", "success");
              log("ç”¨æˆ·ç¡®è®¤ï¼šç´§æ€¥æ±‚åŠ©åŠŸèƒ½æ­£å¸¸å·¥ä½œ");
            } else {
              updateStatus("âŒ æµ‹è¯•å¤±è´¥ï¼Œç´§æ€¥æ±‚åŠ©åŠŸèƒ½ä»æœ‰é—®é¢˜", "error");
              log("ç”¨æˆ·åé¦ˆï¼šç´§æ€¥æ±‚åŠ©åŠŸèƒ½ä»æœ‰é—®é¢˜");
              log("");
              log("=== æ•…éšœæ’é™¤å»ºè®® ===");
              log("1. åˆ·æ–°ä¸»åº”ç”¨é¡µé¢é‡è¯•");
              log("2. æ£€æŸ¥æµè§ˆå™¨Consoleæ˜¯å¦æœ‰é”™è¯¯");
              log("3. å°è¯•ç›´æ¥è®¿é—®: http://localhost:5173/emergency");
              log("4. ç¡®è®¤å‰ç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ");
            }
          }, 15000);
        } else {
          log("âŒ æ— æ³•æ‰“å¼€æ–°çª—å£ï¼Œå¯èƒ½è¢«æµè§ˆå™¨é˜»æ­¢");
          updateStatus(
            "âŒ æ— æ³•æ‰“å¼€æ–°çª—å£ï¼Œè¯·æ‰‹åŠ¨è®¿é—® http://localhost:5173",
            "error"
          );
        }
      }

      // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ä¸»åº”ç”¨çŠ¶æ€
      window.addEventListener("load", () => {
        log("ç®€å•è·¯ç”±æµ‹è¯•å·¥å…·å·²åŠ è½½");

        // æ£€æŸ¥ä¸»åº”ç”¨æ˜¯å¦å¯è®¿é—®
        fetch("http://localhost:5173")
          .then((response) => {
            if (response.ok) {
              log("âœ… ä¸»åº”ç”¨æœåŠ¡æ­£å¸¸è¿è¡Œ");
              updateStatus("ä¸»åº”ç”¨æœåŠ¡æ­£å¸¸ï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•", "success");
            } else {
              log(`âŒ ä¸»åº”ç”¨è¿”å›é”™è¯¯: ${response.status}`);
              updateStatus(`ä¸»åº”ç”¨è®¿é—®å¼‚å¸¸: HTTP ${response.status}`, "error");
            }
          })
          .catch((error) => {
            log(`âŒ æ— æ³•è¿æ¥åˆ°ä¸»åº”ç”¨: ${error.message}`);
            updateStatus("æ— æ³•è¿æ¥åˆ°ä¸»åº”ç”¨ï¼Œè¯·ç¡®è®¤æœåŠ¡æ­£åœ¨è¿è¡Œ", "error");
          });
      });
    </script>
  </body>
</html>
