<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å¯¼èˆªæµ‹è¯• - Emergency Guardian</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #1e3a8a, #7c3aed);
        color: white;
        min-height: 100vh;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        padding: 30px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      }
      .test-section {
        margin: 20px 0;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .test-button {
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        margin: 5px;
        font-size: 14px;
        transition: all 0.3s ease;
      }
      .test-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
      }
      .emergency-button {
        background: linear-gradient(135deg, #ef4444, #dc2626);
      }
      .emergency-button:hover {
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
      }
      .log {
        background: rgba(0, 0, 0, 0.3);
        padding: 15px;
        border-radius: 8px;
        font-family: "Courier New", monospace;
        font-size: 12px;
        max-height: 300px;
        overflow-y: auto;
        margin-top: 15px;
      }
      .status {
        padding: 8px 16px;
        border-radius: 6px;
        margin: 10px 0;
        font-weight: 500;
      }
      .status.success {
        background: rgba(34, 197, 94, 0.2);
        border: 1px solid #22c55e;
      }
      .status.error {
        background: rgba(239, 68, 68, 0.2);
        border: 1px solid #ef4444;
      }
      .status.info {
        background: rgba(59, 130, 246, 0.2);
        border: 1px solid #3b82f6;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸš¨ Emergency Guardian å¯¼èˆªæµ‹è¯•</h1>
      <p>æµ‹è¯•å‰ç«¯åº”ç”¨çš„è·¯ç”±å¯¼èˆªåŠŸèƒ½</p>

      <div class="test-section">
        <h3>ğŸ“ å½“å‰çŠ¶æ€</h3>
        <div id="status" class="status info">æ­£åœ¨åˆå§‹åŒ–...</div>
        <div>
          <strong>å‰ç«¯åº”ç”¨:</strong> <span id="frontend-status">æ£€æµ‹ä¸­...</span
          ><br />
          <strong>å½“å‰é¡µé¢:</strong> <span id="current-page">æœªçŸ¥</span><br />
          <strong>å¯¼èˆªåŠŸèƒ½:</strong> <span id="navigation-status">æœªæµ‹è¯•</span>
        </div>
      </div>

      <div class="test-section">
        <h3>ğŸ§ª å¯¼èˆªæµ‹è¯•</h3>
        <p>ç‚¹å‡»æŒ‰é’®æµ‹è¯•ä¸åŒé¡µé¢çš„å¯¼èˆªåŠŸèƒ½ï¼š</p>

        <button class="test-button" onclick="testNavigation('dashboard')">
          ğŸ  ä¸»é¡µé¢
        </button>
        <button
          class="test-button emergency-button"
          onclick="testNavigation('emergency')"
        >
          ğŸš¨ ç´§æ€¥æ±‚åŠ©
        </button>
        <button class="test-button" onclick="testNavigation('guardians')">
          ğŸ‘¥ ç›‘æŠ¤äºº
        </button>
        <button class="test-button" onclick="testNavigation('settings')">
          âš™ï¸ è®¾ç½®
        </button>
        <button class="test-button" onclick="testNavigation('activities')">
          ğŸ“Š æ´»åŠ¨è®°å½•
        </button>
      </div>

      <div class="test-section">
        <h3>ğŸ” ç›´æ¥URLæµ‹è¯•</h3>
        <p>æµ‹è¯•ç›´æ¥è®¿é—®URLæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p>

        <button
          class="test-button"
          onclick="testDirectURL('http://localhost:5173/')"
        >
          æµ‹è¯•ä¸»é¡µ
        </button>
        <button
          class="test-button emergency-button"
          onclick="testDirectURL('http://localhost:5173/emergency')"
        >
          æµ‹è¯•ç´§æ€¥é¡µé¢
        </button>
        <button
          class="test-button"
          onclick="testDirectURL('http://localhost:5173/guardians')"
        >
          æµ‹è¯•ç›‘æŠ¤äººé¡µé¢
        </button>
      </div>

      <div class="test-section">
        <h3>ğŸ“‹ æµ‹è¯•æ—¥å¿—</h3>
        <button class="test-button" onclick="clearLog()">æ¸…é™¤æ—¥å¿—</button>
        <div id="log" class="log"></div>
      </div>
    </div>

    <script>
      let logElement = document.getElementById("log");
      let statusElement = document.getElementById("status");
      let frontendStatusElement = document.getElementById("frontend-status");
      let currentPageElement = document.getElementById("current-page");
      let navigationStatusElement =
        document.getElementById("navigation-status");

      function log(message, type = "info") {
        const timestamp = new Date().toLocaleTimeString();
        const logEntry = `[${timestamp}] ${message}`;
        console.log(logEntry);

        logElement.innerHTML += `<div style="color: ${
          type === "error"
            ? "#ef4444"
            : type === "success"
            ? "#22c55e"
            : "#ffffff"
        }">${logEntry}</div>`;
        logElement.scrollTop = logElement.scrollHeight;
      }

      function updateStatus(message, type = "info") {
        statusElement.textContent = message;
        statusElement.className = `status ${type}`;
      }

      function clearLog() {
        logElement.innerHTML = "";
      }

      async function checkFrontendStatus() {
        try {
          const response = await fetch("http://localhost:5173/", {
            method: "HEAD",
            mode: "no-cors",
          });
          frontendStatusElement.textContent = "âœ… è¿è¡Œä¸­";
          frontendStatusElement.style.color = "#22c55e";
          log("å‰ç«¯åº”ç”¨çŠ¶æ€æ£€æŸ¥é€šè¿‡", "success");
          return true;
        } catch (error) {
          frontendStatusElement.textContent = "âŒ æ— æ³•è¿æ¥";
          frontendStatusElement.style.color = "#ef4444";
          log(`å‰ç«¯åº”ç”¨è¿æ¥å¤±è´¥: ${error.message}`, "error");
          return false;
        }
      }

      async function testNavigation(route) {
        log(`å¼€å§‹æµ‹è¯•å¯¼èˆªåˆ°: ${route}`);

        try {
          // åœ¨æ–°çª—å£ä¸­æ‰“å¼€é¡µé¢è¿›è¡Œæµ‹è¯•
          const url = `http://localhost:5173/${route}`;
          const testWindow = window.open(url, "_blank", "width=800,height=600");

          if (testWindow) {
            log(`âœ… æˆåŠŸæ‰“å¼€é¡µé¢: ${route}`, "success");

            // ç­‰å¾…ä¸€æ®µæ—¶é—´åæ£€æŸ¥é¡µé¢æ˜¯å¦æ­£å¸¸åŠ è½½
            setTimeout(() => {
              try {
                if (!testWindow.closed) {
                  log(`é¡µé¢ ${route} ä»åœ¨è¿è¡Œï¼Œå¯¼èˆªæˆåŠŸ`, "success");
                  navigationStatusElement.textContent = "âœ… æ­£å¸¸å·¥ä½œ";
                  navigationStatusElement.style.color = "#22c55e";
                }
              } catch (e) {
                log(`æ— æ³•æ£€æŸ¥é¡µé¢çŠ¶æ€ (è·¨åŸŸé™åˆ¶): ${e.message}`);
              }
            }, 2000);
          } else {
            log(`âŒ æ— æ³•æ‰“å¼€é¡µé¢: ${route}`, "error");
            navigationStatusElement.textContent = "âŒ å¯¼èˆªå¤±è´¥";
            navigationStatusElement.style.color = "#ef4444";
          }
        } catch (error) {
          log(`å¯¼èˆªæµ‹è¯•å¤±è´¥: ${error.message}`, "error");
          navigationStatusElement.textContent = "âŒ å¯¼èˆªå¤±è´¥";
          navigationStatusElement.style.color = "#ef4444";
        }
      }

      async function testDirectURL(url) {
        log(`æµ‹è¯•ç›´æ¥è®¿é—®: ${url}`);

        try {
          const testWindow = window.open(url, "_blank", "width=800,height=600");

          if (testWindow) {
            log(`âœ… æˆåŠŸæ‰“å¼€URL: ${url}`, "success");
          } else {
            log(`âŒ æ— æ³•æ‰“å¼€URL: ${url}`, "error");
          }
        } catch (error) {
          log(`URLæµ‹è¯•å¤±è´¥: ${error.message}`, "error");
        }
      }

      // åˆå§‹åŒ–æµ‹è¯•
      async function initialize() {
        log("å¼€å§‹åˆå§‹åŒ–å¯¼èˆªæµ‹è¯•...");
        updateStatus("æ­£åœ¨æ£€æŸ¥å‰ç«¯åº”ç”¨çŠ¶æ€...", "info");

        const frontendOk = await checkFrontendStatus();

        if (frontendOk) {
          updateStatus("âœ… å‰ç«¯åº”ç”¨è¿è¡Œæ­£å¸¸ï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•", "success");
          currentPageElement.textContent = "æµ‹è¯•é¡µé¢";
          log("åˆå§‹åŒ–å®Œæˆï¼Œå¯ä»¥å¼€å§‹å¯¼èˆªæµ‹è¯•", "success");
        } else {
          updateStatus("âŒ å‰ç«¯åº”ç”¨æ— æ³•è¿æ¥ï¼Œè¯·æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯åŠ¨", "error");
          log(
            "åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·ç¡®ä¿å‰ç«¯æœåŠ¡åœ¨ http://localhost:5173 è¿è¡Œ",
            "error"
          );
        }
      }

      // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
      window.addEventListener("load", initialize);

      log("å¯¼èˆªæµ‹è¯•é¡µé¢å·²åŠ è½½");
    </script>
  </body>
</html>
