<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Debug Navigation - Emergency Guardian</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #1e3a8a;
        color: white;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
      }
      .button {
        background: #ef4444;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        margin: 10px;
        font-size: 16px;
      }
      .button:hover {
        background: #dc2626;
      }
      .log {
        background: rgba(0, 0, 0, 0.5);
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
        max-height: 400px;
        overflow-y: auto;
        font-family: monospace;
        font-size: 12px;
      }
      .success {
        color: #10b981;
      }
      .error {
        color: #ef4444;
      }
      .info {
        color: #3b82f6;
      }
      .warning {
        color: #f59e0b;
      }
      iframe {
        width: 100%;
        height: 600px;
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        margin: 20px 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ”§ Debug Navigation Issue</h1>

      <div>
        <h3>Quick Tests</h3>
        <button class="button" onclick="testMainApp()">æµ‹è¯•ä¸»åº”ç”¨</button>
        <button class="button" onclick="testEmergencyDirect()">
          ç›´æ¥æµ‹è¯•ç´§æ€¥é¡µé¢
        </button>
        <button class="button" onclick="openInNewTab()">
          åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ä¸»åº”ç”¨
        </button>
        <button class="button" onclick="clearLogs()">æ¸…é™¤æ—¥å¿—</button>
      </div>

      <div>
        <h3>Embedded Test</h3>
        <iframe id="test-iframe" src="about:blank"></iframe>
        <button class="button" onclick="loadMainAppInIframe()">
          åœ¨iframeä¸­åŠ è½½ä¸»åº”ç”¨
        </button>
      </div>

      <div class="log" id="log"></div>
    </div>

    <script>
      let logElement = document.getElementById("log");

      function log(message, type = "info") {
        const timestamp = new Date().toLocaleTimeString();
        const logEntry = document.createElement("div");
        logEntry.className = type;
        logEntry.textContent = `[${timestamp}] ${message}`;
        logElement.appendChild(logEntry);
        logElement.scrollTop = logElement.scrollHeight;
        console.log(`[${type.toUpperCase()}] ${message}`);
      }

      function clearLogs() {
        logElement.innerHTML = "";
      }

      async function testMainApp() {
        log("æµ‹è¯•ä¸»åº”ç”¨è®¿é—®...", "info");

        try {
          const response = await fetch("http://localhost:5173/");
          if (response.ok) {
            log("ä¸»åº”ç”¨è®¿é—®æˆåŠŸ", "success");
            log("è¯·åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰‹åŠ¨æµ‹è¯•å¯¼èˆª", "info");
          } else {
            log(`ä¸»åº”ç”¨è®¿é—®å¤±è´¥: ${response.status}`, "error");
          }
        } catch (error) {
          log(`ä¸»åº”ç”¨è®¿é—®é”™è¯¯: ${error.message}`, "error");
          log("è¯·ç¡®ä¿è¿è¡Œäº† npm run dev", "warning");
        }
      }

      async function testEmergencyDirect() {
        log("æµ‹è¯•ç´§æ€¥é¡µé¢ç›´æ¥è®¿é—®...", "info");

        try {
          const response = await fetch("http://localhost:5173/emergency");
          if (response.ok) {
            log("ç´§æ€¥é¡µé¢ç›´æ¥è®¿é—®æˆåŠŸ", "success");

            // Open in new tab
            window.open("http://localhost:5173/emergency", "_blank");
            log("ç´§æ€¥é¡µé¢å·²åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€", "info");
          } else {
            log(`ç´§æ€¥é¡µé¢è®¿é—®å¤±è´¥: ${response.status}`, "error");
          }
        } catch (error) {
          log(`ç´§æ€¥é¡µé¢è®¿é—®é”™è¯¯: ${error.message}`, "error");
        }
      }

      function openInNewTab() {
        log("åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ä¸»åº”ç”¨...", "info");

        const newWindow = window.open("http://localhost:5173/", "_blank");
        if (newWindow) {
          log("ä¸»åº”ç”¨å·²åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€", "success");
          log("è¯·æµ‹è¯•ä»¥ä¸‹æ­¥éª¤:", "info");
          log("1. ç­‰å¾…åº”ç”¨åŠ è½½å®Œæˆ", "info");
          log("2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)", "info");
          log('3. ç‚¹å‡»çº¢è‰²çš„"ç´§æ€¥æ±‚åŠ©"æŒ‰é’®', "info");
          log("4. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—è¾“å‡º", "info");
          log("5. æ£€æŸ¥é¡µé¢æ˜¯å¦åˆ‡æ¢åˆ°ç´§æ€¥é¡µé¢", "info");
          log("6. æ£€æŸ¥URLæ˜¯å¦å˜ä¸º /emergency", "info");
        } else {
          log("æ— æ³•æ‰“å¼€æ–°æ ‡ç­¾é¡µ", "error");
        }
      }

      function loadMainAppInIframe() {
        log("åœ¨iframeä¸­åŠ è½½ä¸»åº”ç”¨...", "info");

        const iframe = document.getElementById("test-iframe");
        iframe.src = "http://localhost:5173/";

        iframe.onload = () => {
          log("ä¸»åº”ç”¨å·²åœ¨iframeä¸­åŠ è½½", "success");
          log("æ³¨æ„: iframeä¸­çš„å¯¼èˆªå¯èƒ½å—åˆ°é™åˆ¶", "warning");
        };

        iframe.onerror = () => {
          log("iframeåŠ è½½å¤±è´¥", "error");
        };
      }

      // Initialize
      window.addEventListener("load", () => {
        log("Debug Navigation é¡µé¢å·²åŠ è½½", "info");
        log("å·²åº”ç”¨æ–°çš„å¯¼èˆªä¿®å¤:", "info");
        log("- å…¨å±€çŠ¶æ€ç®¡ç†è·¯ç”±", "success");
        log("- ç§»é™¤ReactçŠ¶æ€ä¾èµ–", "success");
        log("- å¼ºåˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“", "success");

        // Auto test
        setTimeout(testMainApp, 1000);
      });
    </script>
  </body>
</html>
